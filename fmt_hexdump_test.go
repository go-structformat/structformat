package structformat

import "testing"

func TestHexDump(t *testing.T) {
	input := []byte{
		0x38, 0x87, 0x94, 0x46, 0x2d, 0x72, 0xa5, 0x77, 0x47, 0x9c, 0xbb, 0x8c, 0x7b, 0x1a, 0x21, 0x7f,
		0x35, 0x5a, 0xdd, 0xde, 0x3d, 0xb6, 0x95, 0x81, 0xb6, 0xbb, 0xb7, 0x44, 0x93, 0x75, 0x8b, 0xca,
		0xa2, 0x71, 0x52, 0xef, 0x5f, 0x69, 0xdf, 0xfa, 0x59, 0x04, 0xf8, 0x29, 0x4f, 0x96, 0x46, 0x93,
		0x04, 0xc8, 0x0a, 0xcc, 0x58, 0xc6, 0xa0, 0xb7, 0x90, 0x81, 0x1c, 0xa6, 0x5c, 0x8b, 0xe4, 0x8e,
		0x1a, 0xe4, 0x19, 0x63, 0x39, 0x2e, 0xcd, 0x63, 0xf1, 0xe7, 0x37, 0xf2, 0x0c, 0x12, 0x24, 0x6f,
		0x10, 0x96, 0x06, 0xc0, 0xee, 0x56, 0xbb, 0xda, 0x23, 0xaa, 0xae, 0xa8, 0xc6, 0x0f, 0x0a, 0x6d,
		0x7a, 0x09, 0x5e, 0xf5, 0x0d, 0x07, 0xb1, 0x10, 0x2f, 0x93, 0xf0, 0xee, 0x0b, 0xee, 0xa5, 0xef,
		0xb5, 0xaa, 0x4e, 0xac, 0xb8, 0xd4, 0x78, 0x3c, 0x1e, 0x4d, 0xd6, 0x8e, 0x39, 0x03, 0xde, 0xf2,
		0x65, 0x1a, 0x34, 0xcf, 0x56, 0x67, 0x4b, 0x6a, 0x4b, 0x63, 0x61, 0xa5, 0xa3, 0x51, 0x14, 0xb0,
		0xc3, 0xa8, 0x62, 0x55, 0x9f, 0x20, 0x33, 0xfd, 0x33, 0x3d, 0xc4, 0x0d, 0x61, 0x7f, 0x1e, 0xf7,
		0xce, 0xa8, 0x22, 0xfb, 0x30, 0x66, 0xf1, 0x0c, 0xa4, 0x1c, 0xc3, 0xa1, 0xbe, 0x9b, 0xc6, 0xe1,
		0x4e, 0xc9, 0x36, 0xeb, 0x14, 0x45, 0xa3, 0x38, 0x21, 0x44, 0xc8, 0xb4, 0xf5, 0x71, 0xf4, 0x5f,
		0x97, 0xe0, 0x54, 0x42, 0xdd, 0xfc, 0x23, 0x04,
	}
	expect := `00000000  38 87 94 46 2d 72 a5 77  47 9c bb 8c 7b 1a 21 7f  |8..F-r.wG...{.!.|
00000010  35 5a dd de 3d b6 95 81  b6 bb b7 44 93 75 8b ca  |5Z..=......D.u..|
00000020  a2 71 52 ef 5f 69 df fa  59 04 f8 29 4f 96 46 93  |.qR._i..Y..)O.F.|
00000030  04 c8 0a cc 58 c6 a0 b7  90 81 1c a6 5c 8b e4 8e  |....X.......\...|
00000040  1a e4 19 63 39 2e cd 63  f1 e7 37 f2 0c 12 24 6f  |...c9..c..7...$o|
00000050  10 96 06 c0 ee 56 bb da  23 aa ae a8 c6 0f 0a 6d  |.....V..#......m|
00000060  7a 09 5e f5 0d 07 b1 10  2f 93 f0 ee 0b ee a5 ef  |z.^...../.......|
00000070  b5 aa 4e ac b8 d4 78 3c  1e 4d d6 8e 39 03 de f2  |..N...x<.M..9...|
00000080  65 1a 34 cf 56 67 4b 6a  4b 63 61 a5 a3 51 14 b0  |e.4.VgKjKca..Q..|
00000090  c3 a8 62 55 9f 20 33 fd  33 3d c4 0d 61 7f 1e f7  |..bU. 3.3=..a...|
000000a0  ce a8 22 fb 30 66 f1 0c  a4 1c c3 a1 be 9b c6 e1  |..".0f..........|
000000b0  4e c9 36 eb 14 45 a3 38  21 44 c8 b4 f5 71 f4 5f  |N.6..E.8!D...q._|
000000c0  97 e0 54 42 dd fc 23 04  `
	actual, err := FormatString(Hexdump(input))
	if err != nil {
		t.Fatal(err)
	}
	if actual != expect {
		t.Errorf("expects %#v but got %#v", expect, actual)
	}
}

func TestHexDump2(t *testing.T) {
	input := []byte{
		0x38, 0x87, 0x94, 0x46, 0x2d, 0x72, 0xa5, 0x77, 0x47, 0x9c, 0xbb, 0x8c, 0x7b, 0x1a, 0x21, 0x7f,
		0x35, 0x5a, 0xdd, 0xde, 0x3d, 0xb6, 0x95, 0x81, 0xb6, 0xbb, 0xb7, 0x44, 0x93, 0x75, 0x8b, 0xca,
		0xa2, 0x71, 0x52, 0xef, 0x5f, 0x69, 0xdf, 0xfa, 0x59, 0x04, 0xf8, 0x29, 0x4f, 0x96, 0x46, 0x93,
		0x04, 0xc8, 0x0a, 0xcc, 0x58, 0xc6, 0xa0, 0xb7, 0x90, 0x81, 0x1c, 0xa6, 0x5c, 0x8b, 0xe4, 0x8e,
		0x1a, 0xe4, 0x19, 0x63, 0x39, 0x2e, 0xcd, 0x63, 0xf1, 0xe7, 0x37, 0xf2, 0x0c, 0x12, 0x24, 0x6f,
		0x10, 0x96, 0x06, 0xc0, 0xee, 0x56, 0xbb, 0xda, 0x23, 0xaa, 0xae, 0xa8, 0xc6, 0x0f, 0x0a, 0x6d,
		0x7a, 0x09, 0x5e, 0xf5, 0x0d, 0x07, 0xb1, 0x10, 0x2f, 0x93, 0xf0, 0xee, 0x0b, 0xee, 0xa5, 0xef,
		0xb5, 0xaa, 0x4e, 0xac, 0xb8, 0xd4, 0x78, 0x3c, 0x1e, 0x4d, 0xd6, 0x8e, 0x39, 0x03, 0xde, 0xf2,
		0x65, 0x1a, 0x34, 0xcf, 0x56, 0x67, 0x4b, 0x6a, 0x4b, 0x63, 0x61, 0xa5, 0xa3, 0x51, 0x14, 0xb0,
		0xc3, 0xa8, 0x62, 0x55, 0x9f, 0x20, 0x33, 0xfd, 0x33, 0x3d, 0xc4, 0x0d, 0x61, 0x7f, 0x1e, 0xf7,
		0xce, 0xa8, 0x22, 0xfb, 0x30, 0x66, 0xf1, 0x0c, 0xa4, 0x1c, 0xc3, 0xa1, 0xbe, 0x9b, 0xc6, 0xe1,
		0x4e, 0xc9, 0x36, 0xeb, 0x14, 0x45, 0xa3, 0x38, 0x21, 0x44, 0xc8, 0xb4, 0xf5, 0x71, 0xf4, 0x5f,
	}
	expect := `00000000  38 87 94 46 2d 72 a5 77  47 9c bb 8c 7b 1a 21 7f  |8..F-r.wG...{.!.|
00000010  35 5a dd de 3d b6 95 81  b6 bb b7 44 93 75 8b ca  |5Z..=......D.u..|
00000020  a2 71 52 ef 5f 69 df fa  59 04 f8 29 4f 96 46 93  |.qR._i..Y..)O.F.|
00000030  04 c8 0a cc 58 c6 a0 b7  90 81 1c a6 5c 8b e4 8e  |....X.......\...|
00000040  1a e4 19 63 39 2e cd 63  f1 e7 37 f2 0c 12 24 6f  |...c9..c..7...$o|
00000050  10 96 06 c0 ee 56 bb da  23 aa ae a8 c6 0f 0a 6d  |.....V..#......m|
00000060  7a 09 5e f5 0d 07 b1 10  2f 93 f0 ee 0b ee a5 ef  |z.^...../.......|
00000070  b5 aa 4e ac b8 d4 78 3c  1e 4d d6 8e 39 03 de f2  |..N...x<.M..9...|
00000080  65 1a 34 cf 56 67 4b 6a  4b 63 61 a5 a3 51 14 b0  |e.4.VgKjKca..Q..|
00000090  c3 a8 62 55 9f 20 33 fd  33 3d c4 0d 61 7f 1e f7  |..bU. 3.3=..a...|
000000a0  ce a8 22 fb 30 66 f1 0c  a4 1c c3 a1 be 9b c6 e1  |..".0f..........|
000000b0  4e c9 36 eb 14 45 a3 38  21 44 c8 b4 f5 71 f4 5f  |N.6..E.8!D...q._|`
	actual, err := FormatString(Hexdump(input))
	if err != nil {
		t.Fatal(err)
	}
	if actual != expect {
		t.Errorf("expects %#v but got %#v", expect, actual)
	}
}
